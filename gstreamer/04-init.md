# Фреймворк GStreamer. Руководство разработчика приложений. Инициализация библиотеки фреймворка GStreamer [h1-initializing-gstreamer]

Оригинал: GStreamer Application Development Manual  
Авторы: Wim Taymans, Steve Baker, Andy Wingo, Ronald S. Bultje, Stefan Kost  
Дата публикации: 21 мая 2014 г.  
Перевод: А.Панин  
Дата перевода: 18 июня 2014 г.  
Оригинал перевода: [Фреймворк GStreamer. Руководство разработчика приложений. Инициализация библиотеки фреймворка GStreamer](http://rus-linux.net/MyLDP/BOOKS/gstreamer/04-init.html)


## Часть II. Создание приложения [building-an-application]

В следующих главах мы обсудим базовые концепции фреймворка GStreamer и наиболее часто используемые объекты, такие, как элементы, точки соединения и буферы. Мы будем использовать схематичные изображения этих объектов для того, чтобы изобразить более сложные конвейеры, которые вы научитесь создавать позднее. Вы впервые познакомитесь с API фреймворка GStreamer, причем этого знакомства будет достаточно для создания элементарных приложений. Далее в этой части вы найдете информацию о том, как создать простейшее приложение с интерфейсом командной строки.

Учтите, что в данной части вы познакомитесь с низкоуровневыми API и концепциями фреймворка GStreamer. При создании приложений вы можете отдать предпочтение использованию API более высокого уровня. Эти API будут обсуждаться в следующих частях руководства.

## Глава 4. Инициализация библиотеки фреймворка GStreamer [initializing-gstreamer]

При разработке приложения на основе фреймворка GStreamer вы можете просто подключить заголовочный файл `gst/gst.h` для получения доступа к библиотечным функциям. Кроме этого, вам придется инициализировать саму библиотеку фреймворка GStreamer.

### 4.1. Простая инициализация [simple-initialization]

Перед тем, как библиотеки фреймворка GStreamer смогут использоваться, из главного программного потока приложения должен быть осуществлен вызов функции `gst_init`. Этот вызов позволит выполнить необходимые операции инициализации библиотеки, а также разобрать специфичные для фреймворка GStreamer параметры командной строки.

Типичная программа[^1] должна содержать аналогичный следующему код для инициализации библиотеки фреймворка GStreamer:

**Пример 4.1. Инициализация библиотеки фреймворка GStreamer**

```
#include <stdio.h>
#include <gst/gst.h>

int
main (int   argc,
      char *argv[])
{
  const gchar *nano_str;
  guint major, minor, micro, nano;

  gst_init (&argc, &argv);

  gst_version (&major, &minor, &micro, &nano);

  if (nano == 1)
    nano_str = "(CVS)";
  else if (nano == 2)
    nano_str = "(Пре-релиз)";
  else
    nano_str = "";

  printf ("Данная программа связана с библиотекой фреймворка GStreamer версии %d.%d.%d %s\n",
          major, minor, micro, nano_str);

  return 0;
}
```

Используйте макросы `GST_VERSION_MAJOR`, `GST_VERSION_MINOR` и `GST_VERSION_MICRO` для получения версии библиотеки фреймворка GStreamer, с которой будет связываться ваше приложение или функцию `gst_version` для получения версии библиотеки, с которой оно уже связано. На данный момент фреймворк GStreamer использует схему версий, в которой библиотеки одной и той же версии с одной и той же подверсией совместимы на уровне API и ABI.

Также можете вызывать функцию `gst_init` с двумя аргументами `NULL`, но в этом случае никакие из аргументов командной строки не будут разобраны средствами фреймворка GStreamer. 

### 4.2. Интерфейс GOption [the-goption-interface]

Также вы можете использовать интерфейс GOption для инициализации библиотеки фреймворка GStreamer с передачей ваших собственных параметров таким же образом, как показано в следующем примере:

**Пример 4.2. Инициализация с использованием интерфейса GOption**

```
#include <gst/gst.h>

int
main (int   argc,
      char *argv[])
{
  gboolean silent = FALSE;
  gchar *savefile = NULL;
  GOptionContext *ctx;
  GError *err = NULL;
  GOptionEntry entries[] = {
    { "silent", 's', 0, G_OPTION_ARG_NONE, &silent,
      "не выводить информацию о состоянии", NULL },
    { "output", 'o', 0, G_OPTION_ARG_STRING, &savefile,
      "сохранить представление конвейера в формате XML в ФАЙЛ и выйти", "ФАЙЛ" },
    { NULL }
  };

  ctx = g_option_context_new ("- Ваше приложение");
  g_option_context_add_main_entries (ctx, entries, NULL);
  g_option_context_add_group (ctx, gst_init_get_option_group ());
  if (!g_option_context_parse (ctx, &argc, &argv, &err)) {
    g_print ("Не удалось произвести инициализацию: %s\n", err->message);
    g_error_free (err);
    return 1;
  }

  printf ("Запустите программу с аргументом --help для ознакомления с допустимыми параметрами.\n");

  return 0;
}
```

Как показано в данном фрагменте кода, вы можете использовать таблицу [GOption](http://developer.gnome.org/glib/stable/glib-Commandline-option-parser.html) для описания ваших специфичных для приложения параметров командной строки и передавать эту таблицу функции инициализации библиотеки `GLib` вместе с группой параметров, возвращаемой функцией `gst_init_get_option_group`. В этом случае параметры вашего приложения будут разобраны вместе со стандартными параметрами фреймворка GStreamer.

----------

Предыдущий раздел : [Основные концепции](03-intro-basics.html).

Следующий раздел : [Элементы](05-elements.html).

Главная страница : [http://neon1ks.github.io/](../index.html)

[^1]: Код для данного примера автоматически извлечен из документации и добавлен в директорию `tests/examples/manual` архива исходного кода фреймворка GStreamer.
